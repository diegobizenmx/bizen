/* ==========================================
   FONT DEFINITIONS
   ========================================== */

@font-face {
  font-family: 'Feather Bold';
  src: url('/fonts/Feather-Bold.woff2') format('woff2'),
       url('/fonts/Feather-Bold.woff') format('woff'),
       url('/fonts/Feather-Bold.ttf') format('truetype');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Feather Bold';
  src: url('/fonts/Feather-Bold.woff2') format('woff2'),
       url('/fonts/Feather-Bold.woff') format('woff'),
       url('/fonts/Feather-Bold.ttf') format('truetype');
  font-weight: bold;
  font-style: normal;
  font-display: swap;
}

/* ==========================================
   COMPREHENSIVE RESPONSIVE STYLES
   Works on Phone, iPad, and Desktop
   ========================================== */

/* Base responsive sizing for ALL elements */
* {
  box-sizing: border-box;
  font-family: 'Feather Bold', 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
}

/* Prevent text size adjustment on iOS */
html {
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}

/* Responsive Typography */
html {
  font-size: clamp(14px, 2vw, 16px);
  font-family: 'Feather Bold', 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
}

body {
  font-family: 'Feather Bold', 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
}

@media (min-width: 768px) {
  html {
    font-size: clamp(15px, 2.5vw, 16px);
  }
}

@media (min-width: 1024px) {
  html {
    font-size: 16px;
  }
}

/* All Headings - Responsive */
h1, h2, h3, h4, h5, h6 {
  font-family: 'Feather Bold', 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif !important;
}

h1 {
  font-size: clamp(24px, 6vw, 48px) !important;
  line-height: 1.2 !important;
}

h2 {
  font-size: clamp(20px, 5vw, 36px) !important;
  line-height: 1.3 !important;
}

h3 {
  font-size: clamp(18px, 4vw, 28px) !important;
  line-height: 1.4 !important;
}

h4 {
  font-size: clamp(16px, 3vw, 24px) !important;
  line-height: 1.4 !important;
}

/* All Paragraphs - Responsive */
p {
  font-size: clamp(14px, 2vw, 18px) !important;
  line-height: 1.6 !important;
  font-family: 'Feather Bold', 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif !important;
}

/* All Buttons - Responsive */
button, .btn {
  padding: clamp(10px, 2.5vw, 16px) clamp(20px, 4vw, 32px) !important;
  font-size: clamp(14px, 2.5vw, 18px) !important;
  border-radius: clamp(8px, 2vw, 12px) !important;
  font-family: 'Feather Bold', 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif !important;
}

/* Form Inputs - Responsive */
input, textarea, select {
  font-size: clamp(14px, 2vw, 16px) !important;
  padding: clamp(10px, 2.5vw, 14px) !important;
  border-radius: clamp(6px, 1.5vw, 10px) !important;
}

/* Cards and Containers - Responsive Padding */
[class*="card"], [class*="container"], 
[style*="padding:"][style*="px"] {
  /* This is handled inline with clamp() */
}

/* ==========================================
   COMPREHENSIVE DEVICE SIZE BREAKPOINTS
   ========================================== */

/* Extra Small Phones (iPhone SE, small Android) - Portrait */
@media (max-width: 374px) and (orientation: portrait) {
  html {
    font-size: 12px !important;
  }
  
  h1 {
    font-size: clamp(18px, 10vw, 26px) !important;
    line-height: 1.1 !important;
    margin-bottom: 12px !important;
  }
  
  h2 {
    font-size: clamp(16px, 9vw, 22px) !important;
    line-height: 1.2 !important;
    margin-bottom: 10px !important;
  }
  
  h3 {
    font-size: clamp(14px, 8vw, 20px) !important;
    line-height: 1.3 !important;
    margin-bottom: 8px !important;
  }
  
  button, .btn {
    padding: 12px 16px !important;
    font-size: 14px !important;
    min-height: 44px !important;
    min-width: 44px !important;
  }
  
  /* Reduce padding on very small screens */
  main, div[style*="padding"] {
    padding-left: 12px !important;
    padding-right: 12px !important;
    padding-top: 16px !important;
    padding-bottom: 16px !important;
  }
  
  /* Smaller mobile nav buttons */
  [data-mobile-bottom-nav] button {
    min-width: 50px !important;
    width: 50px !important;
    padding: 6px 8px !important;
    font-size: 9px !important;
  }
  
  [data-mobile-bottom-nav] button span:first-child {
    font-size: 20px !important;
  }
  
  /* Reduce gaps and margins */
  * {
    gap: clamp(8px, 2vw, 12px) !important;
  }
  
  /* Smaller cards and containers */
  [class*="card"],
  div[style*="background"][style*="borderRadius"] {
    padding: 12px !important;
    margin-bottom: 12px !important;
  }
  
  /* Compact form inputs */
  input, textarea, select {
    padding: 10px 12px !important;
    font-size: 14px !important;
    min-height: 44px !important;
  }
}

/* Small to Medium Phones - Portrait */
@media (min-width: 375px) and (max-width: 767px) and (orientation: portrait) {
  html {
    font-size: 14px !important;
  }
  
  h1 {
    font-size: clamp(22px, 8vw, 32px) !important;
  }
  
  h2 {
    font-size: clamp(18px, 7vw, 28px) !important;
  }
  
  h3 {
    font-size: clamp(16px, 6vw, 24px) !important;
  }
  
  button, .btn {
    padding: 14px 24px !important;
    font-size: 16px !important;
    min-height: 48px !important;
  }
}

/* Mobile Landscape Orientation */
@media (max-width: 767px) and (orientation: landscape) {
  html {
    font-size: 13px !important;
  }
  
  h1 {
    font-size: clamp(20px, 5vw, 26px) !important;
    line-height: 1.2 !important;
    margin-bottom: 12px !important;
  }
  
  h2 {
    font-size: clamp(16px, 4vw, 22px) !important;
    line-height: 1.3 !important;
    margin-bottom: 10px !important;
  }
  
  h3 {
    font-size: clamp(15px, 3.5vw, 20px) !important;
    line-height: 1.4 !important;
    margin-bottom: 8px !important;
  }
  
  button, .btn {
    padding: 10px 18px !important;
    font-size: 14px !important;
    min-height: 40px !important;
  }
  
  /* Reduce vertical spacing in landscape */
  main {
    padding-top: 20px !important;
    padding-bottom: 20px !important;
  }
  
  /* Compact mobile nav in landscape */
  [data-mobile-bottom-nav] {
    height: 60px !important;
    padding-top: 6px !important;
    padding-bottom: calc(6px + env(safe-area-inset-bottom)) !important;
  }
  
  [data-mobile-bottom-nav] button {
    min-width: 55px !important;
    width: 55px !important;
    padding: 6px 10px !important;
  }
  
  [data-mobile-bottom-nav] button span:first-child {
    font-size: 20px !important;
  }
  
  [data-mobile-bottom-nav] button span:last-child {
    font-size: 9px !important;
  }
  
  /* Adjust body padding for landscape */
  body:has([data-mobile-bottom-nav]) {
    padding-bottom: calc(60px + env(safe-area-inset-bottom)) !important;
  }
  
  /* Prevent content from being hidden by keyboard */
  main, div[role="main"] {
    padding-bottom: calc(60px + env(safe-area-inset-bottom) + 20px) !important;
  }
  
  /* Stack elements more efficiently in landscape */
  [style*="display: flex"][style*="flexDirection: row"] {
    flex-wrap: wrap !important;
    gap: 12px !important;
  }
  
  /* Reduce vertical margins */
  * {
    margin-top: clamp(4px, 1vw, 8px) !important;
    margin-bottom: clamp(4px, 1vw, 8px) !important;
  }
}

/* Tablets - Portrait (iPad, Android tablets) */
@media (min-width: 768px) and (max-width: 1024px) and (orientation: portrait) {
  html {
    font-size: 15px !important;
  }
  
  h1 {
    font-size: clamp(28px, 5vw, 40px) !important;
  }
  
  h2 {
    font-size: clamp(24px, 4vw, 32px) !important;
  }
  
  h3 {
    font-size: clamp(20px, 3vw, 28px) !important;
  }
  
  button, .btn {
    padding: 14px 28px !important;
    font-size: 16px !important;
    min-height: 48px !important;
  }
}

/* Tablets - Landscape */
@media (min-width: 768px) and (max-width: 1024px) and (orientation: landscape) {
  html {
    font-size: 15px !important;
  }
  
  h1 {
    font-size: clamp(24px, 4vw, 36px) !important;
  }
  
  h2 {
    font-size: clamp(20px, 3.5vw, 28px) !important;
  }
  
  h3 {
    font-size: clamp(18px, 3vw, 24px) !important;
  }
  
  button, .btn {
    padding: 12px 24px !important;
    font-size: 15px !important;
  }
}

/* Small Desktop (Laptops) - 1025px to 1366px */
@media (min-width: 1025px) and (max-width: 1366px) {
  html {
    font-size: 16px !important;
  }
  
  h1 {
    font-size: clamp(28px, 3.5vw, 42px) !important;
  }
  
  h2 {
    font-size: clamp(24px, 3vw, 32px) !important;
  }
  
  h3 {
    font-size: clamp(20px, 2.5vw, 26px) !important;
  }
  
  button, .btn {
    padding: 12px 28px !important;
    font-size: 15px !important;
  }
  
  /* Reduce max-widths for smaller screens */
  [style*="maxWidth: 1200px"],
  [style*="max-width: 1200px"] {
    max-width: min(1200px, 95vw) !important;
  }
  
  [style*="maxWidth: 1400px"],
  [style*="max-width: 1400px"] {
    max-width: min(1400px, 95vw) !important;
  }
  
  /* Reduce sidebar margin on smaller screens */
  [style*="marginRight: 320px"],
  [style*="margin-right: 320px"] {
    margin-right: clamp(240px, 25vw, 320px) !important;
  }
  
  /* Reduce padding on smaller screens */
  [style*="padding: 40px"],
  [style*="paddingLeft: 40px"],
  [style*="paddingRight: 40px"],
  [style*="paddingTop: 40px"],
  [style*="paddingBottom: 40px"] {
    padding: clamp(20px, 3vw, 40px) !important;
  }
}

/* Medium Desktop - 1367px to 1440px (13" MacBook Air, smaller laptops) */
@media (min-width: 1367px) and (max-width: 1440px) {
  html {
    font-size: 16px !important;
  }
  
  h1 {
    font-size: clamp(30px, 3.8vw, 48px) !important;
  }
  
  h2 {
    font-size: clamp(26px, 3vw, 38px) !important;
  }
  
  h3 {
    font-size: clamp(22px, 2.5vw, 30px) !important;
  }
  
  button, .btn {
    padding: 14px 32px !important;
    font-size: 16px !important;
  }
  
  /* Responsive max-widths */
  [style*="maxWidth: 1200px"],
  [style*="max-width: 1200px"] {
    max-width: min(1200px, 92vw) !important;
  }
  
  [style*="maxWidth: 1400px"],
  [style*="max-width: 1400px"] {
    max-width: min(1400px, 92vw) !important;
  }
  
  /* Responsive sidebar margin */
  [style*="marginRight: 320px"],
  [style*="margin-right: 320px"] {
    margin-right: clamp(280px, 22vw, 320px) !important;
  }
  
  /* Responsive padding */
  [style*="padding: 40px"],
  [style*="paddingLeft: 40px"],
  [style*="paddingRight: 40px"] {
    padding-left: clamp(24px, 3.5vw, 40px) !important;
    padding-right: clamp(24px, 3.5vw, 40px) !important;
  }
}

/* Large Desktop (Wide screens) - 1441px and above */
@media (min-width: 1441px) {
  html {
    font-size: 16px !important;
  }
  
  h1 {
    font-size: clamp(36px, 4vw, 56px) !important;
  }
  
  h2 {
    font-size: clamp(28px, 3vw, 42px) !important;
  }
  
  h3 {
    font-size: clamp(24px, 2.5vw, 32px) !important;
  }
  
  button, .btn {
    padding: 16px 40px !important;
    font-size: 18px !important;
  }
}

/* Responsive Margins */
@media (max-width: 767px) {
  /* Mobile-first: Reduce spacing on small screens */
  /* Body padding handled by components */
  
  /* Stack elements vertically on mobile */
  .responsive-stack-mobile {
    flex-direction: column !important;
  }
  
  /* Hide less important elements on very small screens */
  .hide-mobile {
    display: none !important;
  }
}

/* Note: Tablet and Desktop optimizations are handled above */

/* Button Groups - Responsive Spacing */
@media (max-width: 767px) {
  button + button {
    margin-top: 12px !important;
    width: 100% !important;
  }
}

/* Grids and Flexbox - Responsive */
@media (max-width: 767px) {
  /* Make multi-column layouts single column on mobile */
  [style*="grid-template-columns"][style*="repeat"] {
    grid-template-columns: 1fr !important;
  }
  
  /* Stack flex containers */
  [style*="display: flex"][style*="row"] {
    flex-direction: column !important;
  }

  /* Explicit opt-out for components that must remain horizontal */
  [data-allow-row="true"] {
    flex-direction: row !important;
    justify-content: space-between !important;
    gap: 4px !important;
  }

  [data-allow-row="true"] > * {
    flex: 1 1 auto !important;
  }
}

/* Images and Media - Responsive */
img, video, iframe, embed, object {
  max-width: 100% !important;
  height: auto !important;
}

/* Ensure images don't overflow on smaller screens */
@media (min-width: 1024px) and (max-width: 1440px) {
  img {
    max-width: 100% !important;
    height: auto !important;
    object-fit: contain !important;
  }
}

/* Prevent horizontal scroll - CRITICAL */
body, html {
  overflow-x: hidden !important;
  overflow-y: auto !important;
  width: 100% !important;
  max-width: 100vw !important;
  position: relative; /* For proper scrolling context */
  height: auto !important;
  min-height: 100vh !important;
}

/* Prevent any element from causing horizontal scroll */
* {
  max-width: 100vw;
  box-sizing: border-box; /* Ensure padding doesn't cause overflow */
}

/* Ensure all main containers allow vertical scrolling */
main[style*="minHeight: 100vh"],
main[style*="min-height: 100vh"],
div[style*="minHeight: 100vh"]:not([data-decorative]),
div[style*="min-height: 100vh"]:not([data-decorative]) {
  overflow-y: visible !important;
  overflow-x: hidden !important;
}

/* Fix for pages with overflowX: hidden but missing overflowY */
main[style*="overflowX: hidden"]:not([style*="overflowY"]),
div[style*="overflowX: hidden"]:not([style*="overflowY"]):not([data-decorative]) {
  overflow-y: visible !important;
}

/* Responsive breakpoints for smaller desktop screens */
/* Very Small Desktop - 1024px to 1280px (13" MacBook Air, small laptops) */
@media (min-width: 1024px) and (max-width: 1280px) {
  /* Ensure content fits on smaller screens */
  body {
    overflow-x: hidden !important;
    overflow-y: auto !important;
  }
  
  /* Reduce fixed widths that might cause overflow */
  [style*="width: calc(100% - 320px)"] {
    width: calc(100% - clamp(240px, 25vw, 320px)) !important;
  }
  
  [style*="maxWidth: calc(100vw - 320px)"] {
    max-width: calc(100vw - clamp(240px, 25vw, 320px)) !important;
  }
  
  [style*="maxWidth: calc(100vw - 340px)"] {
    max-width: calc(100vw - clamp(260px, 27vw, 340px)) !important;
  }
  
  /* Reduce padding that might push content out */
  [style*="paddingRight: 360px"] {
    padding-right: clamp(260px, 28vw, 360px) !important;
  }
  
  /* Ensure all containers use box-sizing */
  main, div[style*="minHeight: 100vh"] {
    box-sizing: border-box !important;
  }
  
  /* Make sure content doesn't overflow */
  * {
    max-width: 100% !important;
  }
  
  /* Responsive font sizes for smaller screens */
  h1 { font-size: clamp(24px, 4vw, 36px) !important; }
  h2 { font-size: clamp(20px, 3.5vw, 28px) !important; }
  h3 { font-size: clamp(18px, 3vw, 24px) !important; }
}

/* Small Desktop - 1281px to 1440px */
@media (min-width: 1281px) and (max-width: 1440px) {
  /* Slightly less aggressive adjustments */
  [style*="width: calc(100% - 320px)"] {
    width: calc(100% - clamp(280px, 22vw, 320px)) !important;
  }
  
  [style*="maxWidth: calc(100vw - 320px)"] {
    max-width: calc(100vw - clamp(280px, 22vw, 320px)) !important;
  }
  
  [style*="paddingRight: 360px"] {
    padding-right: clamp(300px, 25vw, 360px) !important;
  }
}

/* Responsive Sidebar */
@media (min-width: 1024px) and (max-width: 1280px) {
  [data-fixed-sidebar] {
    width: clamp(240px, 25vw, 300px) !important;
  }
}

@media (min-width: 1281px) and (max-width: 1440px) {
  [data-fixed-sidebar] {
    width: clamp(280px, 22vw, 320px) !important;
  }
}

/* Force containers to stay within viewport - MOBILE ONLY */
@media (max-width: 767px) {
  body > * {
    width: 100% !important;
    max-width: 100vw !important;
  }
  
  /* Allow vertical scrolling on mobile */
  body, html {
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important; /* Smooth scrolling on iOS */
  }
  
  /* Prevent scroll on fixed elements that shouldn't scroll */
  [data-fixed-sidebar],
  [data-mobile-bottom-nav] {
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
}

/* Touch-friendly tap targets */
@media (max-width: 767px) {
  button, a, [role="button"] {
    min-height: 44px !important; /* Apple HIG minimum */
    min-width: 44px !important;
  }
}

/* Responsive utilities */
.responsive-padding {
  padding: clamp(12px, 3vw, 24px) !important;
}

.responsive-margin {
  margin: clamp(8px, 2vw, 16px) !important;
}

.responsive-font {
  font-size: clamp(14px, 2vw, 16px) !important;
}

.responsive-heading {
  font-size: clamp(20px, 5vw, 32px) !important;
}

/* Text Alignment on Mobile - Optional class-based */
@media (max-width: 767px) {
  /* Only apply if classes are used, don't force all headings */
  .mobile-center h1, .mobile-center h2, .mobile-center h3, 
  .mobile-center h4, .mobile-center h5, .mobile-center h6 {
    text-align: center !important;
  }

}

/* ==========================================
   MOBILE RESPONSIVENESS (Phones < 768px)
   ========================================== */

/* Hide FixedSidebar on mobile to maximize content space */
@media (max-width: 767px) {
  [data-fixed-sidebar] {
    display: none !important;
  }
  
  /* Remove right margins that account for sidebar on mobile */
  main[style*="marginRight"]:not([style*="marginRight: 0"]):not([style*="marginRight:0"]):not([style*="marginRight: \"0\""]),
  div[style*="marginRight"]:not([style*="marginRight: 0"]):not([style*="marginRight:0"]):not([style*="marginRight: \"0\""]) {
    margin-right: 0 !important;
  }
  
  /* Adjust right padding to be responsive instead of fixed sidebar values (320px, 340px) */
  main[style*="paddingRight"]:not([style*="paddingRight: 0"]):not([style*="paddingRight:0"]):not([style*="paddingRight: \"0\""]),
  div[style*="paddingRight"]:not([style*="paddingRight: 0"]):not([style*="paddingRight:0"]):not([style*="paddingRight: \"0\""]) {
    padding-right: clamp(16px, 4vw, 24px) !important;
  }
  
  /* Remove left padding that accounts for sidebar if any */
  main[style*="paddingLeft"]:not([style*="paddingLeft: 0"]):not([style*="paddingLeft:0"]):not([style*="paddingLeft: \"0\""]),
  div[style*="paddingLeft"]:not([style*="paddingLeft: 0"]):not([style*="paddingLeft:0"]):not([style*="paddingLeft: \"0\""]) {
    padding-left: clamp(16px, 4vw, 24px) !important;
  }
  
  /* Ensure content containers don't exceed viewport width */
  main[style*="maxWidth"] {
    max-width: 100% !important;
  }
  
  /* Box sizing for all main elements */
  main {
    box-sizing: border-box !important;
  }
  
  /* Specific fixes for common patterns */
  /* Forum pages background containers */
  div[style*="marginRight"][style*="background"] {
    margin-right: 0 !important;
  }
  
  /* Learning pages that use 160px for centering */
  div[style*="marginRight"][style*="160px"] {
    margin-right: 0 !important;
  }
  
  /* Hide fixed left panels on mobile (like courses difficulty navigation) */
  div[style*="position: fixed"][style*="left: 0"][style*="width: 200px"],
  div[style*="position:fixed"][style*="left:0"][style*="width:200px"] {
    display: none !important;
  }
  
  /* Remove left margins that account for fixed panels on mobile */
  div[style*="marginLeft"][style*="200px"],
  div[style*="marginLeft"][style*="200"] {
    margin-left: 0 !important;
  }
  
  /* Adjust left padding that accounts for fixed panels */
  div[style*="paddingLeft"][style*="200px"],
  div[style*="paddingLeft"][style*="200"] {
    padding-left: clamp(16px, 4vw, 24px) !important;
  }
  
  /* Fix calc() widths that account for sidebar - make full width on mobile */
  /* Specifically target calc() patterns in style attributes */
  *[style*="calc(100% - 320px)"],
  *[style*="calc(100vw - 320px)"],
  *[style*="calc(100vw - 340px)"] {
    width: 100% !important;
    max-width: 100% !important;
  }
  
  /* Ensure all main elements use full width on mobile */
  main {
    width: 100% !important;
    max-width: 100vw !important;
    padding-left: clamp(16px, 4vw, 24px) !important;
    padding-right: clamp(16px, 4vw, 24px) !important;
  }
  
  /* Container elements should also be full width on mobile */
  div[role="main"],
  div[style*="maxWidth"] {
    max-width: 100% !important;
  }
  
  /* Optimize decorative elements on mobile */
  div[style*="position: fixed"][style*="width: 400px"],
  div[style*="position:fixed"][style*="width:400px"],
  div[style*="position: fixed"][style*="width: 450px"],
  div[style*="position:fixed"][style*="width:450px"],
  div[style*="position: fixed"][style*="width: 500px"],
  div[style*="position:fixed"][style*="width:500px"] {
    width: 150px !important;
    height: 150px !important;
    opacity: 0.3 !important;
  }
  
  /* Fix sticky course bar positioning on mobile */
  div[style*="left: 200px"][style*="right: 320px"],
  div[style*="left:200px"][style*="right:320px"] {
    left: 0 !important;
    right: 0 !important;
    padding: 0 clamp(16px, 4vw, 24px) !important;
  }
  
  /* Optimize course content container on mobile */
  div[style*="marginLeft: 200px"],
  div[style*="marginLeft:200px"],
  div[style*="paddingLeft: 200px"],
  div[style*="paddingLeft:200px"] {
    margin-left: 0 !important;
    padding-left: clamp(16px, 4vw, 24px) !important;
  }
  
  /* Ensure main containers use responsive padding */
  main {
    padding-left: clamp(16px, 4vw, 24px) !important;
    padding-right: clamp(16px, 4vw, 24px) !important;
  }
  
  /* Remove right margins that account for sidebar on specific pages */
  div[style*="marginRight: 340px"],
  div[style*="marginRight:340px"],
  div[style*="marginRight: \"340px\""] {
    margin-right: 0 !important;
  }
  
  /* Optimize form inputs for mobile */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="number"],
  textarea,
  select {
    font-size: 16px !important; /* Prevents zoom on iOS */
    min-height: 48px !important; /* Touch-friendly */
    padding: 12px 16px !important;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
  }
  
  /* Ensure buttons are touch-friendly */
  button, a[role="button"] {
    min-height: 48px !important;
    padding: 14px 20px !important;
    font-size: 16px !important;
    touch-action: manipulation; /* Removes 300ms delay */
    -webkit-tap-highlight-color: rgba(15, 98, 254, 0.2); /* iOS tap highlight */
    user-select: none; /* Prevent text selection on tap */
    -webkit-user-select: none;
  }
  
  /* Mobile nav buttons get extra touch optimization */
  [data-mobile-bottom-nav] button {
    min-height: 56px !important; /* Larger touch target for nav */
    min-width: 56px !important;
  }
  
  /* Stack form elements vertically on mobile */
  /* Only apply to direct children to avoid breaking nested layouts */
  form > input:not([type="checkbox"]):not([type="radio"]),
  form > textarea,
  form > select,
  form > button:not(:last-child) {
    display: block !important;
    width: 100% !important;
    margin-bottom: 16px !important;
  }
  
  /* Optimize cards for mobile */
  [class*="card"],
  div[style*="background"][style*="borderRadius"] {
    padding: clamp(16px, 4vw, 24px) !important;
    margin-bottom: clamp(16px, 4vw, 24px) !important;
  }
  
  /* Optimize tables for mobile */
  table {
    width: 100% !important;
    font-size: 14px !important;
    display: block !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Optimize images for mobile */
  img {
    max-width: 100% !important;
    height: auto !important;
    display: block !important;
  }
  
  /* Optimize multi-column grid layouts for mobile - only for 2+ columns */
  [style*="grid-template-columns: repeat(2"],
  [style*="grid-template-columns: repeat(3"],
  [style*="grid-template-columns: repeat(4"],
  [style*="grid-template-columns: repeat(5"],
  [style*="grid-template-columns: repeat(6"] {
    grid-template-columns: 1fr !important;
    gap: clamp(16px, 4vw, 24px) !important;
  }
  
  /* Optimize flex row layouts for mobile - only when explicitly set to row */
  /* Note: Only apply when it's safe to stack vertically */
  [style*="display: flex"][style*="flex-direction: row"] {
    /* Don't force column - let components handle their own responsive behavior */
  }
  
  /* Ensure modals and dialogs are mobile-friendly */
  div[style*="position: fixed"][style*="max-width: 480px"],
  div[style*="position:fixed"][style*="max-width:480px"] {
    max-width: 90vw !important;
    margin: 20px auto !important;
    left: 5vw !important;
    right: 5vw !important;
  }
  
  /* Optimize text sizes for mobile readability */
  small {
    font-size: 12px !important;
  }
  
  /* Improve font rendering on mobile */
  body {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }
  
  /* Prevent text size adjustment on orientation change (iOS) */
  html {
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }
  
  /* Optimize paragraph spacing for mobile readability */
  /* Only apply if not already set inline */
  p:not([style*="margin"]) {
    line-height: 1.6 !important;
    margin-bottom: 16px !important;
  }
  
  /* Remove any fixed heights that might cause issues */
  /* But preserve heights for sidebar and mobile nav */
  div[style*="height: 100vh"]:not([data-fixed-sidebar]):not([data-mobile-bottom-nav]):not([data-keep-height]) {
    min-height: 100vh !important;
    height: auto !important;
  }
  
  /* Ensure courses page container scrolls properly */
  div[style*="overflowY: auto"][style*="overflowX: hidden"] {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Add bottom padding to account for mobile bottom nav */
  /* Use safe area insets for iOS devices with notches */
  body:has([data-mobile-bottom-nav]) {
    padding-bottom: calc(70px + env(safe-area-inset-bottom)) !important;
  }
  
  /* Fallback for browsers that don't support :has() */
  @supports not selector(:has(*)) {
    body {
      padding-bottom: calc(70px + env(safe-area-inset-bottom)) !important;
    }
  }
  
  /* Ensure viewport meta tag respects safe areas */
  @supports (padding: max(0px)) {
    body:has([data-mobile-bottom-nav]) {
      padding-bottom: max(70px, calc(70px + env(safe-area-inset-bottom))) !important;
    }
  }
  
  /* Prevent content from being hidden behind mobile nav */
  main,
  div[role="main"] {
    padding-bottom: calc(80px + env(safe-area-inset-bottom)) !important;
  }
  
  /* Optimize modal z-index to appear above mobile nav */
  /* Only target modals/dialogs, not all fixed elements */
  div[style*="position: fixed"][style*="backdrop-filter"],
  div[style*="position:fixed"][style*="backdropFilter"] {
    z-index: 10001 !important; /* Above mobile nav (10000) */
  }
}

/* ==========================================
   ADVANCED MOBILE ANIMATIONS & TRANSITIONS
   ========================================== */

@media (max-width: 767px) {
  /* Smooth page transitions */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideInFromRight {
    from {
      opacity: 0;
      transform: translateX(20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes slideInFromLeft {
    from {
      opacity: 0;
      transform: translateX(-20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  /* More menu popup animation */
  @keyframes slideUpFade {
    from {
      opacity: 0;
      transform: translateY(10px) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  /* Smooth transitions for interactive elements */
  button, a, [role="button"] {
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
  }

  /* Stagger animation for list items */
  [data-stagger] > * {
    animation: fadeInUp 0.3s ease-out both;
  }

  [data-stagger] > *:nth-child(1) { animation-delay: 0.05s; }
  [data-stagger] > *:nth-child(2) { animation-delay: 0.1s; }
  [data-stagger] > *:nth-child(3) { animation-delay: 0.15s; }
  [data-stagger] > *:nth-child(4) { animation-delay: 0.2s; }
  [data-stagger] > *:nth-child(5) { animation-delay: 0.25s; }
  [data-stagger] > *:nth-child(n+6) { animation-delay: 0.3s; }

  /* Pull-to-refresh animation */
  @keyframes pullRefresh {
    0% {
      transform: translateY(-10px);
    }
    50% {
      transform: translateY(0);
    }
    100% {
      transform: translateY(-10px);
    }
  }

  /* Swipe gesture feedback */
  [data-swipe-active="left"],
  [data-swipe-active="right"] {
    transition: transform 0.2s ease-out;
  }

  [data-swipe-active="left"] {
    transform: translateX(-10px);
  }

  [data-swipe-active="right"] {
    transform: translateX(10px);
  }
}

/* ==========================================
   TABLET RESPONSIVENESS (iPad, Android tablets)
   ========================================== */

/* Hide FixedSidebar on tablets to maximize content space */
@media (min-width: 768px) and (max-width: 1024px) {
  [data-fixed-sidebar] {
    display: none !important;
  }
}

/* Tablet adjustments - Override inline styles that account for sidebar */
@media (min-width: 768px) and (max-width: 1024px) {
  /* Remove right margins that account for sidebar */
  /* Target common sidebar margin values: 320px, 340px, 160px */
  main[style*="marginRight"]:not([style*="marginRight: 0"]):not([style*="marginRight:0"]):not([style*="marginRight: \"0\""]),
  div[style*="marginRight"]:not([style*="marginRight: 0"]):not([style*="marginRight:0"]):not([style*="marginRight: \"0\""]) {
    margin-right: 0 !important;
  }
  
  /* Adjust right padding to be responsive instead of fixed sidebar values (320px, 340px) */
  main[style*="paddingRight"]:not([style*="paddingRight: 0"]):not([style*="paddingRight:0"]):not([style*="paddingRight: \"0\""]),
  div[style*="paddingRight"]:not([style*="paddingRight: 0"]):not([style*="paddingRight:0"]):not([style*="paddingRight: \"0\""]) {
    padding-right: clamp(20px, 4vw, 40px) !important;
  }
  
  /* Ensure content containers don't exceed viewport width */
  main[style*="maxWidth"] {
    max-width: 100% !important;
  }
  
  /* Box sizing for all main elements */
  main {
    box-sizing: border-box !important;
  }
  
  /* Specific fixes for common patterns */
  /* Forum pages background containers */
  div[style*="marginRight"][style*="background"] {
    margin-right: 0 !important;
  }
  
  /* Learning pages that use 160px for centering */
  div[style*="marginRight"][style*="160px"] {
    margin-right: auto !important;
  }
}

/* Tablet Portrait - Optimized spacing */
@media (min-width: 768px) and (max-width: 1024px) and (orientation: portrait) {
  /* Ensure main content has appropriate padding */
  main {
    padding-left: clamp(20px, 4vw, 40px) !important;
    padding-right: clamp(20px, 4vw, 40px) !important;
  }
  
  /* Improve button spacing */
  button {
    min-width: 120px !important;
    padding: clamp(12px, 2vw, 16px) clamp(20px, 4vw, 28px) !important;
  }
  
  /* Card spacing adjustments */
  [style*="gap"] {
    gap: clamp(16px, 3vw, 24px) !important;
  }
}

/* Tablet Landscape - More horizontal space */
@media (min-width: 768px) and (max-width: 1024px) and (orientation: landscape) {
  /* Slightly more padding in landscape for better use of space */
  main {
    padding-left: clamp(24px, 5vw, 48px) !important;
    padding-right: clamp(24px, 5vw, 48px) !important;
  }
  
  /* Allow more columns in landscape */
  [style*="grid-template-columns"] {
    /* Grids will maintain their original layout in landscape */
  }
}

/* ==========================================
   THEME SYSTEM (Dark Mode & Accessibility)
   ========================================== */

:root {
  --transition-duration: 300ms;
}

/* Light Theme (Default) */
.light {
  --bg-primary: #ffffff;
  --bg-secondary: #f9fafb;
  --bg-tertiary: #f3f4f6;
  --text-primary: #0f172a;
  --text-secondary: #6b7280;
  --text-tertiary: #9ca3af;
  --border-color: #e5e7eb;
  --accent-color: #0f62fe;
  --accent-hover: #0842a0;
}

/* Dark Theme */
.dark {
  --bg-primary: #0f172a;
  --bg-secondary: #1e293b;
  --bg-tertiary: #334155;
  --text-primary: #f8fafc;
  --text-secondary: #cbd5e1;
  --text-tertiary: #94a3b8;
  --border-color: #475569;
  --accent-color: #3b82f6;
  --accent-hover: #60a5fa;
}

html.dark {
  background: var(--bg-primary);
  color: var(--text-primary);
}

html.dark body {
  background: var(--bg-primary);
  color: var(--text-primary);
}

/* High Contrast Mode */
.high-contrast {
  --bg-primary: #000000;
  --bg-secondary: #1a1a1a;
  --bg-tertiary: #2a2a2a;
  --text-primary: #ffffff;
  --text-secondary: #e0e0e0;
  --text-tertiary: #c0c0c0;
  --border-color: #ffffff;
  --accent-color: #ffff00;
  --accent-hover: #ffcc00;
}

.high-contrast * {
  border-color: var(--border-color) !important;
}

.high-contrast a,
.high-contrast button {
  outline: 2px solid var(--accent-color);
  outline-offset: 2px;
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Apply transition duration from settings */
* {
  transition-duration: var(--transition-duration) !important;
}

/* Keyboard Navigation Focus Styles */
html.keyboard-nav *:focus {
  outline: 3px solid var(--accent-color);
  outline-offset: 2px;
}

