/* eslint-disable @next/next/no-img-element */
"use client"

import * as React from "react"
import { useMemo, useState } from "react"
import { motion, Variants } from "framer-motion"

type LayoutOption = "A" | "B"

type Page1Props = {
  brandName?: string
  logoSrc?: string
  primaryColor?: string
  background?: string
  progressPercent?: number
  title?: string
  topicTitle?: string
  introText?: string
  keyIdea?: string
  whyTitle?: string
  whyBody?: string
  whyExampleTitle?: string
  whyExampleText?: string
  glossaryTitle?: string
  glossaryItems?: string[]
  stepsTitle?: string
  stepsItems?: string[]
  errorsTitle?: string
  errorsItems?: string[]
  qaTitle?: string
  qaItems?: string[]
  heroImage?: string
  layoutOption?: LayoutOption
  baseFontSize?: number
}

type QAItem = { q: string; a: string }
type MCQ = { text: string; context?: string; options: string[]; correctIndex: number }

type Page2Props = {
  brandName?: string
  logoSrc?: string
  primaryColor?: string
  background?: string
  progressPercent?: number
  title?: string
  topicTitle?: string
  heroImage?: string
  layoutOption?: LayoutOption
  baseFontSize?: number
  awarenessImage?: string
  considerationImage?: string
  conversionImage?: string
  postImage?: string
}

const MAX_WIDTH = 1200

const containerVar: Variants = {
  hidden: { opacity: 0, y: 16 },
  show: { opacity: 1, y: 0, transition: { staggerChildren: 0.06, ease: "easeOut" } },
}
const itemVar: Variants = {
  hidden: { opacity: 0, y: 10 },
  show: { opacity: 1, y: 0, transition: { ease: "easeOut" } },
}

const DEFAULT_STEPS = [
  "Elige 3 colores que contrasten entre sí.",
  "Elige 1 tipografía y úsala siempre en títulos.",
  "Redacta títulos de 4–6 palabras con verbo + beneficio.",
  "Deja aire visual (espacio vacío) alrededor del texto.",
]

const DEFAULT_CHECKLIST = [
  "¿Mi título se lee en móvil?",
  "¿Uso siempre los mismos colores/tipografía?",
  "¿Mi encuadre se repite y se reconoce?",
]

const DEFAULT_QA: QAItem[] = [
  {
    q: "¿Cómo elijo mis 3 colores?",
    a: "Base (tu tono principal), apoyo (complementa) y acento (para llamar la atención).",
  },
  {
    q: "¿Cuánto texto en portada?",
    a: "Lo mínimo para entender el tema sin esfuerzo.",
  },
]

const DEFAULT_QUESTIONS: MCQ[] = [
  {
    text: "¿Qué propósito conceptual tiene definir ‘constantes visuales’?",
    context: "Crear reconocimiento y reducir fricción al producir contenido.",
    options: [
      "Evitar toda variación",
      "Producir sin limitaciones",
      "Anclar identidad con paleta, tipografía y encuadre",
      "Usar filtros cada vez",
    ],
    correctIndex: 2,
  },
  {
    text: "¿Qué principio guía la elección tipográfica para portadas?",
    context: "Legibilidad y jerarquía son esenciales para comprensión rápida.",
    options: [
      "Decoración ante todo",
      "Contraste y tamaño adecuados",
      "La tipografía de moda",
      "Mezclar varias por diseño",
    ],
    correctIndex: 1,
  },
  {
    text: "¿Cuál es la función del ‘aire visual’ en diseño?",
    context: "El espacio vacío dirige la atención a lo importante.",
    options: [
      "Rellenar con stickers",
      "Descanso y jerarquía",
      "Ocultar errores",
      "Permitir más texto",
    ],
    correctIndex: 1,
  },
  {
    text: "¿Qué significa consistencia entre plataformas?",
    context: "Esencia y valores reconocibles con adaptación de formato.",
    options: [
      "Copiar exacto en todas",
      "Mantener identidad y adaptar duración/ratio/texto",
      "Usar siempre el mismo copy",
      "Cambiar identidad según plataforma",
    ],
    correctIndex: 1,
  },
  {
    text: "¿Qué rol conceptual cumple un ‘clóset cápsula’ para creadores?",
    context: "Reduce decisiones y mantiene una estética estable.",
    options: [
      "Tener ropa infinita",
      "Pocas prendas combinables que te favorecen",
      "Solo prendas negras",
      "Vestuario temático diario",
    ],
    correctIndex: 1,
  },
  {
    text: "¿Qué objetivo conceptual tiene la paleta de colores?",
    context: "Construir reconocimiento y armonía con la identidad.",
    options: [
      "Impresionar por saturación",
      "Cambiar sin reglas",
      "Sostener una atmósfera reconocible",
      "Elegir al azar",
    ],
    correctIndex: 2,
  },
  {
    text: "El uso consistente de una tipografía y estructura de portada ayuda a que te reconozcan más rápido.",
    context: "La repetición estratégica crea huella.",
    options: ["Verdadero", "Falso"],
    correctIndex: 0,
  },
  {
    text: "Los logotipos grandes en ropa incrementan la atención en el contenido educativo.",
    context: "Desvían la mirada del mensaje principal.",
    options: ["Verdadero", "Falso"],
    correctIndex: 1,
  },
  {
    text: "Aplicar muchos filtros diferentes es una vía para construir coherencia visual.",
    context: "Suele producir ruido y fatiga visual.",
    options: ["Verdadero", "Falso"],
    correctIndex: 1,
  },
  {
    text: "Una guía simple documentada (constantes y ejemplos sí/no) facilita la consistencia.",
    context: "Sistematizar ahorra tiempo y errores.",
    options: ["Verdadero", "Falso"],
    correctIndex: 0,
  },
  {
    text: "La consistencia impide la creatividad.",
    context: "Un marco claro libera energía para el contenido.",
    options: ["Verdadero", "Falso"],
    correctIndex: 1,
  },
  {
    text: "Tarjeta: “Jerarquía visual” ¿Qué prioriza?",
    context: "Ordenar elementos para que el ojo sepa por dónde leer.",
    options: ["Decoración", "Títulos claros y contrastados", "Mucho texto pequeño", "Fondos llenos"],
    correctIndex: 1,
  },
  {
    text: "Tarjeta: “Reconocimiento de marca” ¿Qué lo impulsa?",
    context: "Repetición de constantes y promesa clara.",
    options: ["Cambios impredecibles", "Constantes visuales + mensaje consistente", "Filtros aleatorios", "Títulos crípticos"],
    correctIndex: 1,
  },
  {
    text: "Tarjeta: “Adaptación de formato” ¿Qué implica?",
    context: "Modificar duración/ratio/portada manteniendo la esencia.",
    options: ["Uniformidad total", "Cambiar identidad", "Ajustar forma, conservar fondo conceptual", "Evitar portadas"],
    correctIndex: 2,
  },
  {
    text: "Tarjeta: “Minimalismo útil” ¿Qué promueve?",
    context: "Eliminar lo que no aporta para mejorar comprensión.",
    options: ["Añadir elementos por estética", "Menos es más cuando mejora claridad", "Saturación de colores", "Tipografías múltiples"],
    correctIndex: 1,
  },
]

const DEFAULT_STYLE_INSTRUCTIONS = [
  "PALETA: Define 3 colores con buen contraste — base (tu tono principal), apoyo (complementa) y acento (para llamar la atención). Explica por qué te favorecen.",
  "PRENDAS: Especifica el tipo de prendas que usarás (ej.: lisas, cortes simples, pocos estampados) y cómo refuerzan tu identidad.",
  "ENCUADRE: Describe tu encuadre habitual (altura de ojos, fondo simple, manos visibles a la altura del pecho).",
  "PORTADAS/MINIATURAS: Reglas simples: títulos de 4–6 palabras con verbo + beneficio, alto contraste y aire visual alrededor del texto.",
  "CIERRE: Termina con 1 frase sobre por qué estas elecciones reflejan quién eres.",
]

function Card({
  children,
  glow,
  borderColor = "rgba(0,0,0,0.08)",
}: {
  children: React.ReactNode
  glow?: string
  borderColor?: string
}) {
  return (
    <div
      style={{
        position: "relative" as const,
        borderRadius: 16,
        padding: 20,
        border: `1px solid ${borderColor}`,
        background: "linear-gradient(180deg, #fff, #ffffffcc)",
        backdropFilter: "blur(6px)",
        boxShadow: "0 10px 30px rgba(0,0,0,0.06)",
        overflow: "hidden" as const,
      }}
    >
      {glow ? (
        <div
          style={{
            position: "absolute" as const,
            inset: -120,
            pointerEvents: "none",
            background: `radial-gradient(600px 300px at 20% 0%, ${glow}22, transparent 60%)`,
          }}
        />
      ) : null}
      {children}
    </div>
  )
}

function GridFlashcards({ children, gap = 16, columns = 1 }: { children: React.ReactNode; gap?: number; columns?: number }) {
  return (
    <div
      style={{
        display: "grid" as const,
        gridTemplateColumns: `repeat(${columns}, 1fr)`,
        gap,
        alignItems: "stretch" as const,
        width: "100%",
      }}
    >
      {children}
    </div>
  )
}

function Flashcard({
  front,
  back,
  primaryColor,
  fontSize,
}: {
  front: string
  back: string
  primaryColor: string
  fontSize: number
}) {
  const [open, setOpen] = useState(false)
  return (
    <motion.div
      role="button"
      onClick={() => setOpen((value) => !value)}
      whileHover={{ scale: 0.9 }}
      whileTap={{ scale: 0.9 }}
      transition={{ type: "spring", stiffness: 280, damping: 20 }}
      style={{
        userSelect: "none",
        cursor: "pointer",
        borderRadius: 16,
        border: `1px solid ${primaryColor}33`,
        background: open ? `${primaryColor}0F` : "#fff",
        padding: 18,
        minHeight: 200,
        boxShadow: "0 10px 28px rgba(0,0,0,0.06)",
        display: "flex" as const,
        flexDirection: "column" as const,
        gap: 12,
        transformOrigin: "center",
        willChange: "transform",
      }}
    >
      <strong
        style={{
          color: primaryColor,
          display: "block" as const,
          fontSize: fontSize * 1.1,
          lineHeight: 1.2,
        }}
      >
        {front}
      </strong>

      <p
        style={{
          margin: 0,
          opacity: 0.95,
          fontSize,
          lineHeight: 1.55,
          flex: 1,
        }}
      >
        {open ? back : "Toca para ver"}
      </p>
    </motion.div>
  )
}

function Btn({
  children,
  onClick,
  variant = "primary",
  disabled,
  primaryColor,
}: {
  children: React.ReactNode
  onClick?: () => void
  variant?: "primary" | "ghost"
  disabled?: boolean
  primaryColor: string
}) {
  const base: React.CSSProperties = {
    padding: "12px 16px",
    borderRadius: 12,
    fontWeight: 700,
    cursor: disabled ? "not-allowed" : "pointer",
    opacity: disabled ? 0.6 : 1,
    userSelect: "none",
    outline: "none",
    border: "none",
    transformOrigin: "center",
    willChange: "transform",
  }

  const styles: Record<"primary" | "ghost", React.CSSProperties> = {
    primary: {
      ...base,
      background: primaryColor,
      color: "#fff",
      border: `1px solid ${primaryColor}`,
    },
    ghost: {
      ...base,
      background: "#fff",
      color: "#111",
      border: "1px solid rgba(0,0,0,0.12)",
    },
  }

  return (
    <motion.button
      type="button"
      onClick={disabled ? undefined : onClick}
      style={styles[variant]}
      whileHover={disabled ? {} : { scale: 0.9 }}
      whileTap={disabled ? {} : { scale: 0.9 }}
      transition={{ type: "spring", stiffness: 320, damping: 22 }}
    >
      {children}
    </motion.button>
  )
}

function Page1({
  brandName = "BIZEN",
  logoSrc = "/bizen-mondragonlogo.png",
  primaryColor = "#0F62FE",
  background = "linear-gradient(180deg, #FFFFFF, #F8FAFF)",
  progressPercent = 30,
  title = "Sección 3",
  topicTitle = "Constantes visuales, tipografía y paleta",
  introText = "",
  keyIdea = "Un estilo claro y consistente mejora el reconocimiento al instante y reduce fricción al consumir tu contenido.",
  whyTitle = "1) ¿Por qué importa?",
  whyBody = "Un estilo claro hace que te reconozcan en segundos. Si tus títulos, colores y encuadre se repiten, tu audiencia te identifica incluso antes de leer tu nombre.",
  whyExampleTitle = "Ejemplos",
  whyExampleText = "Titular breve con alto contraste (“Presenta claro hoy”), misma tipografía en todas tus portadas y encuadre similar en tus videos.",
  glossaryTitle = "2) Glosario y decisiones",
  glossaryItems = [
    "Constantes visuales: decisiones que repites (colores, letra, encuadre).",
    "Tipografía legible: letra clara para leer rápido.",
    "Paleta simple: color base + apoyo + acento con buen contraste.",
    "Decisión práctica: define un formato de portada y úsalo en todos tus videos.",
  ],
  stepsTitle = "3) Pasos aplicables hoy",
  stepsItems = [],
  errorsTitle = "Errores comunes",
  errorsItems = [],
  qaTitle = "4) Q&A rápido",
  qaItems = [],
  heroImage = "",
  layoutOption = "A",
  baseFontSize = 18,
}: Page1Props) {
  const fs = Math.max(12, baseFontSize || 18)
  const isA = layoutOption === "A"
  const pct = Math.max(0, Math.min(100, Math.round(progressPercent || 0)))

  const wrapper: React.CSSProperties = useMemo(
    () => ({
      width: "100%",
      display: "flex" as const,
      justifyContent: isA ? "flex-start" : "center",
      background,
      color: "#111",
      fontFamily:
        "Montserrat, Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji",
      fontSize: fs,
    }),
    [background, isA, fs]
  )

  const container: React.CSSProperties = useMemo(
    () => ({
      width: "100%",
      maxWidth: isA ? "none" : MAX_WIDTH,
      padding: "20px",
      boxSizing: "border-box" as const,
    }),
    [isA]
  )

  return (
    <div style={wrapper}>
      <main style={{ width: "100%" }}>
        <header style={{ ...container, paddingTop: 12, paddingBottom: 8 }}>
          <div style={{ display: "flex" as const, alignItems: "center" as const, gap: 12 }}>
            {logoSrc ? (
              <img src={logoSrc} alt={`${brandName} logo`} style={{ height: 62, width: "auto", display: "block" }} />
            ) : (
              <div aria-hidden style={{ width: 28, height: 28, borderRadius: 8, background: primaryColor }} />
            )}
            <strong style={{ letterSpacing: 0.2, fontWeight: 800, color: primaryColor, fontSize: fs * 1.35 }}>{brandName}</strong>
          </div>
        </header>

        <div style={{ ...container, paddingTop: 0 }}>
          <div style={{ display: "flex" as const, alignItems: "center" as const, gap: 12, marginBottom: 8 }}>
            <motion.span
              initial={{ scale: 1 }}
              animate={{ scale: [1, 1.15, 1] }}
              transition={{ duration: 1.2, repeat: Infinity, ease: "easeInOut" }}
              style={{
                display: "inline-flex" as const,
                alignItems: "center" as const,
                justifyContent: "center" as const,
                minWidth: 54,
                height: 28,
                padding: "6px 10px",
                borderRadius: 999,
                background: `${primaryColor}14`,
                color: primaryColor,
                fontWeight: 800,
                fontSize: fs * 0.9,
              }}
              aria-label="porcentaje de avance"
            >
              {pct}%
            </motion.span>

            <div
              style={{
                flex: 1,
                height: 8,
                background: "rgba(0,0,0,0.08)",
                borderRadius: 999,
                overflow: "hidden" as const,
              }}
            >
              <div
                style={{
                  width: `${pct}%`,
                  height: "100%",
                  background: primaryColor,
                  borderRadius: 999,
                  transition: "width 220ms ease",
                }}
              />
            </div>
          </div>
        </div>

        <section>
          <div style={{ ...container }}>
            <motion.div variants={containerVar} initial="hidden" animate="show">
              <motion.div variants={itemVar} style={{ marginBottom: 12 }}>
                <h1 style={{ margin: 0, fontSize: fs * 2.2, lineHeight: 1.15 }}>{title}</h1>
                <p style={{ margin: "6px 0 0", opacity: 0.9, fontSize: fs * 1.15 }}>
                  <span style={{ color: primaryColor, fontWeight: 700 }}>▌</span> {topicTitle}
                </p>
              </motion.div>

              {heroImage ? (
                <motion.div
                  variants={itemVar}
                  style={{ borderRadius: 16, overflow: "hidden" as const, boxShadow: "0 18px 60px rgba(0,0,0,0.12)", marginTop: 14, marginBottom: 16 }}
                >
                  <img src={heroImage} alt="Sección 3" style={{ width: "100%", height: "auto", display: "block" }} />
                </motion.div>
              ) : null}

              {introText ? (
                <motion.div variants={itemVar} style={{ marginBottom: 16 }}>
                  <Card glow={primaryColor}>
                    <p style={{ margin: 0, opacity: 0.95, fontSize: fs }}>{introText}</p>
                  </Card>
                </motion.div>
              ) : null}

              {keyIdea ? (
                <motion.div variants={itemVar} style={{ marginBottom: 16 }}>
                  <div
                    style={{
                      border: `1px solid ${primaryColor}44`,
                      background: `${primaryColor}0F`,
                      color: "#111",
                      borderRadius: 16,
                      padding: 16,
                    }}
                  >
                    <strong style={{ color: primaryColor, display: "block" as const, marginBottom: 6, fontSize: fs }}>Idea clave</strong>
                    <p style={{ margin: 0, opacity: 0.95, fontSize: fs }}>{keyIdea}</p>
                  </div>
                </motion.div>
              ) : null}

              <motion.div variants={itemVar} style={{ marginBottom: 16 }}>
                <Card glow={primaryColor}>
                  <h3 style={{ margin: "0 0 10px 0", fontSize: fs * 1.355 }}>{whyTitle}</h3>
                  <p style={{ margin: 0, opacity: 0.95, lineHeight: 1.55 }}>{whyBody}</p>
                  <div style={{ marginTop: 12 }}>
                    <strong style={{ color: primaryColor, display: "block" as const, marginBottom: 6 }}>{whyExampleTitle}</strong>
                    <p style={{ margin: 0, opacity: 0.95 }}>{whyExampleText}</p>
                  </div>
                </Card>
              </motion.div>

              <motion.div variants={itemVar} style={{ marginBottom: 16 }}>
                <Card glow={primaryColor}>
                  <h3 style={{ margin: "0 0 10px 0", fontSize: fs * 1.355 }}>{glossaryTitle}</h3>
                  <ul style={{ margin: 0, paddingLeft: 18, opacity: 0.95 }}>
                    {glossaryItems.map((text, index) => (
                      <li key={`g-${index}`} style={{ marginBottom: 6 }}>
                        {text}
                      </li>
                    ))}
                  </ul>
                </Card>
              </motion.div>

              {(stepsItems.length > 0 || errorsItems.length > 0) && (
                <motion.div variants={itemVar} style={{ marginBottom: 16 }}>
                  <Card glow={primaryColor}>
                    {stepsItems.length > 0 ? (
                      <>
                        <h3 style={{ margin: "0 0 10px 0", fontSize: fs * 1.355 }}>{stepsTitle}</h3>
                        <ul style={{ margin: 0, paddingLeft: 18, opacity: 0.95 }}>
                          {stepsItems.map((text, index) => (
                            <li key={`s-${index}`} style={{ marginBottom: 6 }}>
                              {text}
                            </li>
                          ))}
                        </ul>
                      </>
                    ) : null}

                    {errorsItems.length > 0 ? (
                      <>
                        <h4 style={{ margin: "14px 0 8px 0", color: primaryColor, fontSize: fs * 1.1 }}>{errorsTitle}</h4>
                        <ul style={{ margin: 0, paddingLeft: 18, opacity: 0.95 }}>
                          {errorsItems.map((text, index) => (
                            <li key={`e-${index}`} style={{ marginBottom: 6 }}>
                              {text}
                            </li>
                          ))}
                        </ul>
                      </>
                    ) : null}
                  </Card>
                </motion.div>
              )}

              {qaItems.length > 0 ? (
                <motion.div variants={itemVar} style={{ marginBottom: 16 }}>
                  <Card glow={primaryColor}>
                    <h3 style={{ margin: "0 0 10px 0", fontSize: fs * 1.355 }}>{qaTitle}</h3>
                    <ul style={{ margin: 0, paddingLeft: 18, opacity: 0.95 }}>
                      {qaItems.map((text, index) => (
                        <li key={`qa-${index}`} style={{ marginBottom: 6 }}>
                          {text}
                        </li>
                      ))}
                    </ul>
                  </Card>
                </motion.div>
              ) : null}
            </motion.div>
          </div>
        </section>
      </main>
    </div>
  )
}

function Page2({
  brandName = "BIZEN",
  logoSrc = "/bizen-mondragonlogo.png",
  primaryColor = "#0F62FE",
  background = "linear-gradient(180deg, #FFFFFF, #F8FAFF)",
  progressPercent = 10,
  title = "Sección 1",
  topicTitle = "Pasos aplicables hoy + Checklist + Q&A",
  heroImage = "",
  layoutOption = "B",
  baseFontSize = 18,
  awarenessImage = "",
  considerationImage = "",
  conversionImage = "",
  postImage = "",
}: Page2Props) {
  void awarenessImage
  void considerationImage
  void conversionImage
  void postImage

  const fs = Math.max(12, baseFontSize || 18)
  const isA = layoutOption === "A"
  const pct = Math.max(0, Math.min(100, Math.round(progressPercent || 0)))

  const wrapper: React.CSSProperties = useMemo(
    () => ({
      width: "100%",
      minHeight: "100vh",
      display: "flex" as const,
      justifyContent: isA ? "flex-start" : "center",
      background,
      color: "#111",
      fontFamily:
        'Montserrat, Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji',
      fontSize: fs,
    }),
    [background, isA, fs]
  )

  const container: React.CSSProperties = useMemo(
    () => ({
      width: "100%",
      padding: "clamp(16px, 3vw, 32px)",
      boxSizing: "border-box" as const,
      margin: isA ? "0" : "0 auto",
    }),
    [isA]
  )

  const steps = DEFAULT_STEPS
  const checklist = DEFAULT_CHECKLIST
  const qaList = DEFAULT_QA

  return (
    <div style={wrapper}>
      <main
        style={{
          width: "100%",
          display: "flex" as const,
          flexDirection: "column" as const,
          flex: 1,
          minHeight: "100vh",
        }}
      >
        <header style={{ ...container, paddingTop: 12, paddingBottom: 8 }}>
          <div
            style={{
              display: "flex" as const,
              alignItems: "center" as const,
              gap: 12,
            }}
          >
            {logoSrc ? (
              <img
                src={logoSrc}
                alt={`${brandName} logo`}
                style={{
                  height: 62,
                  width: "auto",
                  display: "block" as const,
                }}
              />
            ) : (
              <div
                aria-hidden
                style={{
                  width: 28,
                  height: 28,
                  borderRadius: 8,
                  background: primaryColor,
                }}
              />
            )}
            <strong style={{ letterSpacing: 0.2, fontWeight: 800, color: primaryColor, fontSize: fs * 1.35 }}>{brandName}</strong>
          </div>
        </header>

        <div style={{ ...container, paddingTop: 0 }}>
          <div
            style={{
              display: "flex" as const,
              alignItems: "center" as const,
              gap: 12,
              marginBottom: 14,
            }}
          >
            <motion.span
              initial={{ scale: 1 }}
              animate={{ scale: [1, 1.15, 1] }}
              transition={{
                duration: 1.2,
                repeat: Infinity,
                ease: "easeInOut",
              }}
              style={{
                display: "inline-flex" as const,
                alignItems: "center" as const,
                gap: 8,
                padding: "8px 12px",
                borderRadius: 999,
                background: `${primaryColor}14`,
                color: primaryColor,
                fontWeight: 700,
                fontSize: fs * 0.95,
              }}
              aria-label="porcentaje de avance del curso"
            >
              {pct}%
            </motion.span>
            <div
              style={{
                flex: 1,
                height: 10,
                background: "rgba(0,0,0,0.08)",
                borderRadius: 999,
                overflow: "hidden" as const,
              }}
            >
              <motion.div
                initial={{ scaleY: 1 }}
                animate={{ scaleY: [1, 1.06, 1] }}
                transition={{
                  duration: 1.2,
                  repeat: Infinity,
                  ease: "easeInOut",
                }}
                style={{
                  width: `${pct}%`,
                  height: "100%",
                  background: primaryColor,
                  borderRadius: 999,
                  transformOrigin: "center",
                }}
              />
            </div>
          </div>
        </div>

        <section style={{ flex: 1, display: "block" }}>
          <div style={{ ...container }}>
            <motion.div variants={containerVar} initial="hidden" animate="show">
              <motion.div variants={itemVar} style={{ marginBottom: 18 }}>
                <h1
                  style={{
                    margin: 0,
                    fontSize: fs * 2.3,
                    lineHeight: 1.15,
                  }}
                >
                  {title}
                </h1>
                <p
                  style={{
                    margin: "8px 0 0",
                    opacity: 0.9,
                    fontSize: fs * 1.15,
                  }}
                >
                  <span
                    style={{
                      color: primaryColor,
                      fontWeight: 700,
                    }}
                  >
                    ▌
                  </span>{" "}
                  {topicTitle}
                </p>
              </motion.div>

              {heroImage ? (
                <motion.div
                  variants={itemVar}
                  style={{
                    borderRadius: 16,
                    overflow: "hidden" as const,
                    boxShadow: "0 18px 60px rgba(0,0,0,0.12)",
                    marginTop: 16,
                    marginBottom: 18,
                  }}
                >
                  <img
                    src={heroImage}
                    alt="Sección 1"
                    style={{ width: "100%", height: "auto", display: "block" }}
                  />
                </motion.div>
              ) : null}

              <motion.div variants={itemVar} style={{ marginBottom: 12 }}>
                <Card glow={primaryColor}>
                  <h3
                    style={{
                      margin: "0 0 12px 0",
                      fontSize: fs * 1.355,
                    }}
                  >
                    3) Pasos aplicables hoy
                  </h3>
                  <ul
                    style={{
                      margin: 0,
                      paddingLeft: 22,
                      fontSize: fs,
                      lineHeight: 1.55,
                    }}
                  >
                    {steps.map((step, index) => (
                      <li key={index}>{step}</li>
                    ))}
                  </ul>
                </Card>
              </motion.div>

              <motion.div variants={itemVar} style={{ marginBottom: 12 }}>
                <Card glow={primaryColor}>
                  <h3
                    style={{
                      margin: "0 0 12px 0",
                      fontSize: fs * 1.355,
                    }}
                  >
                    Checklist express
                  </h3>
                  <ul
                    style={{
                      margin: 0,
                      paddingLeft: 22,
                      fontSize: fs,
                      lineHeight: 1.55,
                    }}
                  >
                    {checklist.map((item, index) => (
                      <li key={index}>{item}</li>
                    ))}
                  </ul>
                </Card>
              </motion.div>

              <motion.div variants={itemVar} style={{ marginBottom: 12 }}>
                <Card glow={primaryColor}>
                  <h3
                    style={{
                      margin: "0 0 12px 0",
                      fontSize: fs * 1.355,
                    }}
                  >
                    4) Q&A rápido
                  </h3>
                  <dl
                    style={{
                      margin: 0,
                      display: "grid" as const,
                      gridTemplateColumns: "1fr",
                      gap: 10,
                    }}
                  >
                    {qaList.map(({ q, a }, index) => (
                      <div
                        key={index}
                        style={{
                          border: `1px solid ${primaryColor}22`,
                          borderRadius: 12,
                          background: "#fff",
                          padding: 12,
                        }}
                      >
                        <dt
                          style={{
                            margin: 0,
                            fontWeight: 800,
                            color: primaryColor,
                            fontSize: fs * 1.05,
                          }}
                        >
                          {q}
                        </dt>
                        <dd
                          style={{
                            margin: "6px 0 0",
                            opacity: 0.95,
                            fontSize: fs,
                            lineHeight: 1.5,
                          }}
                        >
                          {a}
                        </dd>
                      </div>
                    ))}
                  </dl>
                </Card>
              </motion.div>
            </motion.div>
          </div>
        </section>
      </main>
    </div>
  )
}

type Page3Props = {
  brandName?: string
  logoSrc?: string
  primaryColor?: string
  background?: string
  progressPercent?: number
  title?: string
  topicTitle?: string
  layoutOption?: LayoutOption
  baseFontSize?: number
  videoSrc?: string
  videoPoster?: string
}

type Page4Props = {
  brandName?: string
  logoSrc?: string
  primaryColor?: string
  background?: string
  progressPercent?: number
  title?: string
  topicTitle?: string
  layoutOption?: LayoutOption
  baseFontSize?: number
  autoAdvanceDelayMs?: number
}

type Page5Props = {
  brandName?: string
  logoSrc?: string
  primaryColor?: string
  background?: string
  progressPercent?: number
  title?: string
  topicTitle?: string
  layoutOption?: LayoutOption
  baseFontSize?: number
  instructions?: string[]
  gridColumns?: number
  gridGap?: number
}

function Page3({
  brandName = "BIZEN",
  logoSrc = "/bizen-mondragonlogo.png",
  primaryColor = "#0F62FE",
  background = "linear-gradient(180deg, #FFFFFF, #F8FAFF)",
  progressPercent = 10,
  title = "Sección 3 · Tips de estilo y consistencia visual",
  topicTitle = "Constantes, tipografía, aire y consistencia — Opción múltiple (15)",
  layoutOption = "B",
  baseFontSize = 18,
  videoSrc = "",
  videoPoster = "",
}: Page3Props) {
  const fs = Math.max(12, baseFontSize || 18)
  const isA = layoutOption === "A"
  const pct = Math.max(0, Math.min(100, Math.round(progressPercent || 0)))

  const wrapper = useMemo(
    () => ({
      width: "100%",
      display: "flex" as const,
      justifyContent: isA ? "flex-start" : "center",
      background,
      color: "#111",
      fontFamily:
        "Montserrat, Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji",
      fontSize: fs,
    }),
    [background, isA, fs]
  )

  const container = useMemo(
    () => ({
      width: "100%",
      padding: "clamp(16px, 3vw, 32px)",
      boxSizing: "border-box" as const,
      margin: isA ? "0" : "0 auto",
    }),
    [isA]
  )

  const total = DEFAULT_QUESTIONS.length
  const [idx, setIdx] = useState(0)
  const [selection, setSelection] = useState<(number | null)[]>(() => Array(total).fill(null))
  const [checked, setChecked] = useState<boolean[]>(() => Array(total).fill(false))
  const [correct, setCorrect] = useState<boolean[]>(() => Array(total).fill(false))
  const [score, setScore] = useState(0)

  const q = DEFAULT_QUESTIONS[idx]
  const quizProgressPct = Math.round(((idx + 1) / total) * 100)
  const answeredCount = checked.filter(Boolean).length
  const finished = answeredCount === total

  const selectAndAdvance = (optionIndex: number) => {
    if (checked[idx]) return
    const isCorrect = optionIndex === q.correctIndex

    setSelection((prev) => {
      const next = [...prev]
      next[idx] = optionIndex
      return next
    })

    setChecked((prev) => {
      const next = [...prev]
      next[idx] = true
      return next
    })

    setCorrect((prev) => {
      const next = [...prev]
      next[idx] = isCorrect
      return next
    })

    if (isCorrect) setScore((value) => value + 1)

    setTimeout(() => setIdx((value) => Math.min(total - 1, value + 1)), 220)
  }

  const goPrev = () => setIdx((value) => Math.max(0, value - 1))
  const goNext = () => setIdx((value) => Math.min(total - 1, value + 1))

  const optStyle = (active: boolean): React.CSSProperties => ({
    padding: "14px 16px",
    borderRadius: 12,
    border: `2px solid ${active ? primaryColor : "rgba(0,0,0,0.12)"}`,
    background: active ? `${primaryColor}14` : "#fff",
    fontWeight: 700,
    fontSize: fs * 1.0,
    letterSpacing: 0.2,
    cursor: "pointer",
    userSelect: "none",
    textAlign: "left",
    boxShadow: active ? "0 8px 24px rgba(0,0,0,0.06)" : "none",
    willChange: "transform",
    transformOrigin: "center",
  })

  const feedback: React.ReactNode =
    checked[idx] && correct[idx] ? (
      <div style={{ color: "#0a7f35", fontWeight: 700 }}>✅ ¡Correcto!</div>
    ) : checked[idx] && !correct[idx] ? (
      <div style={{ color: "#b00020", fontWeight: 700 }}>
        ❌ Incorrecto. Respuesta: <strong>{q.options[q.correctIndex]}</strong>
      </div>
    ) : null

  return (
    <div style={wrapper}>
      <main
        style={{
          width: "100%",
          display: "flex" as const,
          flexDirection: "column" as const,
          flex: 1,
          minHeight: "100vh",
        }}
      >
        <header style={{ ...container, paddingTop: 12, paddingBottom: 8 }}>
          <div
            style={{
              display: "flex" as const,
              alignItems: "center" as const,
              gap: 12,
            }}
          >
            {logoSrc ? (
              <img
                src={logoSrc}
                alt={`${brandName} logo`}
                style={{
                  height: 62,
                  width: "auto",
                  display: "block" as const,
                }}
              />
            ) : (
              <div
                aria-hidden
                style={{
                  width: 28,
                  height: 28,
                  borderRadius: 8,
                  background: primaryColor,
                }}
              />
            )}
            <strong style={{ letterSpacing: 0.2, fontWeight: 800, color: primaryColor, fontSize: fs * 1.35 }}>{brandName}</strong>
          </div>
        </header>

        <div style={{ ...container, paddingTop: 0 }}>
          <div
            style={{
              display: "flex" as const,
              alignItems: "center" as const,
              gap: 12,
              marginBottom: 14,
            }}
          >
            <motion.span
              initial={{ scale: 1 }}
              animate={{ scale: [1, 1.15, 1] }}
              transition={{
                duration: 1.2,
                repeat: Infinity,
                ease: "easeInOut",
              }}
              style={{
                display: "inline-flex" as const,
                alignItems: "center" as const,
                gap: 8,
                padding: "8px 12px",
                borderRadius: 999,
                background: `${primaryColor}14`,
                color: primaryColor,
                fontWeight: 700,
                fontSize: fs * 0.95,
              }}
              aria-label="porcentaje de avance del curso"
            >
              {pct}%
            </motion.span>
            <div
              style={{
                flex: 1,
                height: 10,
                background: "rgba(0,0,0,0.08)",
                borderRadius: 999,
                overflow: "hidden" as const,
              }}
            >
              <motion.div
                initial={{ scaleY: 1 }}
                animate={{ scaleY: [1, 1.06, 1] }}
                transition={{
                  duration: 1.2,
                  repeat: Infinity,
                  ease: "easeInOut",
                }}
                style={{
                  width: `${pct}%`,
                  height: "100%",
                  background: primaryColor,
                  borderRadius: 999,
                  transformOrigin: "center",
                }}
              />
            </div>
          </div>
        </div>

        <header style={{ ...container, paddingTop: 16, paddingBottom: 8 }}>
          <motion.div variants={containerVar} initial="hidden" animate="show">
            <motion.div variants={itemVar} style={{ marginBottom: 18 }}>
              <h1 style={{ margin: 0, fontSize: fs * 2.3, lineHeight: 1.15 }}>{title}</h1>
              <p style={{ margin: "8px 0 0", opacity: 0.9, fontSize: fs * 1.15 }}>
                <span style={{ color: primaryColor, fontWeight: 700 }}>▌</span> {topicTitle}
              </p>
            </motion.div>
          </motion.div>
        </header>

        <section>
          <div style={{ ...container }}>
            <motion.div variants={containerVar} initial="hidden" animate="show">
              <motion.div variants={itemVar} style={{ marginBottom: 24 }}>
                <Card glow={primaryColor}>
                  {videoSrc ? (
                    <video
                      src={videoSrc}
                      poster={videoPoster || undefined}
                      controls
                      playsInline
                      style={{
                        width: "100%",
                        height: "auto",
                        display: "block" as const,
                        borderRadius: 12,
                        outline: "none",
                      }}
                    />
                  ) : (
                    <div
                      style={{
                        width: "100%",
                        display: "flex" as const,
                        alignItems: "center" as const,
                        justifyContent: "center" as const,
                        borderRadius: 12,
                        border: "2px dashed rgba(0,0,0,0.12)",
                        background: "#fff",
                        padding: 16,
                        textAlign: "center",
                      }}
                    >
                      <div>
                        <div style={{ fontWeight: 800, marginBottom: 6, color: primaryColor, fontSize: fs * 1.05 }}>
                          Espacio para tu video
                        </div>
                        <div style={{ opacity: 0.7 }}>Sube tu archivo desde tu UI.</div>
                      </div>
                    </div>
                  )}
                </Card>
              </motion.div>

              <motion.div variants={itemVar}>
                <Card glow={primaryColor}>
                  <div
                    style={{
                      display: "flex" as const,
                      alignItems: "center" as const,
                      justifyContent: "space-between" as const,
                      marginBottom: 14,
                    }}
                  >
                    <strong style={{ fontSize: fs * 1.1 }}>
                      Pregunta {idx + 1} / {total}
                    </strong>
                    <div style={{ display: "flex" as const, alignItems: "center" as const, gap: 10 }}>
                      <div
                        style={{
                          width: 220,
                          height: 12,
                          background: "rgba(0,0,0,0.08)",
                          borderRadius: 999,
                          overflow: "hidden" as const,
                        }}
                      >
                        <div
                          style={{
                            width: `${quizProgressPct}%`,
                            height: "100%",
                            background: primaryColor,
                            borderRadius: 999,
                            transition: "width 220ms ease",
                          }}
                        />
                      </div>
                      <span style={{ fontSize: fs * 0.95, opacity: 0.75 }}>{quizProgressPct}%</span>
                    </div>
                  </div>

                  <div style={{ margin: "10px 0 18px", lineHeight: 1.55, fontSize: fs * 1.15 }}>
                    <p style={{ margin: 0 }}>{q.text}</p>
                    {q.context ? (
                      <p style={{ margin: "6px 0 0", opacity: 0.8, fontSize: fs * 0.95 }}>{q.context}</p>
                    ) : null}
                  </div>

                  <div
                    style={{
                      display: "grid" as const,
                      gridTemplateColumns: "repeat(auto-fit, minmax(260px, 1fr))",
                      gap: 16,
                      marginBottom: 16,
                    }}
                  >
                    {q.options.map((option, index) => {
                      const active = selection[idx] === index
                      const disabled = !!checked[idx]
                      return (
                        <motion.div
                          key={index}
                          role="button"
                          onClick={() => (!disabled ? selectAndAdvance(index) : undefined)}
                          style={optStyle(active)}
                          whileHover={disabled ? {} : { scale: 0.9 }}
                          whileTap={disabled ? {} : { scale: 0.9 }}
                          transition={{ type: "spring", stiffness: 320, damping: 22 }}
                        >
                          {option}
                        </motion.div>
                      )
                    })}
                  </div>

                  <div style={{ marginBottom: 14 }}>{feedback}</div>

                  <div
                    style={{
                      display: "flex" as const,
                      alignItems: "center" as const,
                      justifyContent: "space-between" as const,
                      gap: 12,
                      flexWrap: "wrap",
                    }}
                  >
                    <div style={{ display: "flex" as const, gap: 12 }}>
                      <Btn onClick={goPrev} variant="ghost" primaryColor={primaryColor} disabled={idx === 0}>
                        ← Anterior
                      </Btn>
                      <Btn onClick={goNext} variant="ghost" primaryColor={primaryColor} disabled={idx === total - 1}>
                        Siguiente →
                      </Btn>
                    </div>

                    <span style={{ opacity: 0.8, fontSize: fs * 0.95 }}>
                      {checked.filter(Boolean).length}/{total} respondidas
                    </span>
                  </div>

                  {finished ? (
                    <div
                      style={{
                        marginTop: 18,
                        padding: 16,
                        border: `1px solid ${primaryColor}33`,
                        borderRadius: 12,
                        background: "#fff",
                        display: "flex" as const,
                        alignItems: "center" as const,
                        justifyContent: "space-between" as const,
                      }}
                    >
                      <strong>Resultado:</strong>
                      <span style={{ fontWeight: 800, color: primaryColor }}>
                        {score} / {total}
                      </span>
                    </div>
                  ) : null}
                </Card>
              </motion.div>
            </motion.div>
          </div>
        </section>
      </main>
    </div>
  )
}

function Page4({
  brandName = "BIZEN",
  logoSrc = "/bizen-mondragonlogo.png",
  primaryColor = "#0F62FE",
  background = "linear-gradient(180deg, #FFFFFF, #F8FAFF)",
  progressPercent = 10,
  title = "Sección 3",
  topicTitle = "Tips de estilo y consistencia visual (15 preguntas)",
  layoutOption = "B",
  baseFontSize = 18,
  autoAdvanceDelayMs = 650,
}: Page4Props) {
  const fs = Math.max(12, baseFontSize || 18)
  const isA = layoutOption === "A"
  const pct = Math.max(0, Math.min(100, Math.round(progressPercent || 0)))

  const wrapper = useMemo(
    () => ({
      width: "100%",
      display: "flex" as const,
      justifyContent: isA ? "flex-start" : "center",
      background,
      color: "#111",
      fontFamily:
        "Montserrat, Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji",
      fontSize: fs,
    }),
    [background, isA, fs]
  )

  const container = useMemo(
    () => ({
      width: "100%",
      padding: "clamp(16px, 3vw, 32px)",
      boxSizing: "border-box" as const,
      margin: isA ? "0" : "0 auto",
    }),
    [isA]
  )

  const total = DEFAULT_QUESTIONS.length
  const [idx, setIdx] = useState(0)
  const [selection, setSelection] = useState<(number | null)[]>(() => Array(total).fill(null))
  const [checked, setChecked] = useState<boolean[]>(() => Array(total).fill(false))
  const [correct, setCorrect] = useState<boolean[]>(() => Array(total).fill(false))
  const [score, setScore] = useState(0)

  const q = idx >= 0 && idx < total ? DEFAULT_QUESTIONS[idx] : null
  const quizProgressPct = Math.round(((idx + 1) / total) * 100)
  const answeredCount = checked.filter(Boolean).length
  const finished = answeredCount === total
  const formattedQuestion =
    q && typeof q.context === "string" && q.context.length > 0
      ? `${q.text}\nContexto: ${q.context}`
      : q?.text ?? "—"

  const handleSelect = (optionIndex: number) => {
    if (!q) return
    if (checked[idx]) return
    if (optionIndex < 0 || optionIndex >= q.options.length) return

    setSelection((prev) => {
      const next = [...prev]
      next[idx] = optionIndex
      return next
    })

    const isCorrect = optionIndex === q.correctIndex
    setChecked((prev) => {
      const next = [...prev]
      next[idx] = true
      return next
    })
    setCorrect((prev) => {
      const next = [...prev]
      next[idx] = isCorrect
      return next
    })
    if (isCorrect) setScore((value) => value + 1)

    setTimeout(() => {
      setIdx((value) => (value < total - 1 ? value + 1 : value))
    }, autoAdvanceDelayMs)
  }

  return (
    <div style={wrapper}>
      <main style={{ width: "100%", display: "block" }}>
        <header style={{ ...container, paddingTop: 12, paddingBottom: 8 }}>
          <div style={{ display: "flex" as const, alignItems: "center" as const, gap: 12 }}>
            {logoSrc ? (
              <img src={logoSrc} alt={`${brandName} logo`} style={{ height: 62, width: "auto", display: "block" }} />
            ) : (
              <div aria-hidden style={{ width: 28, height: 28, borderRadius: 8, background: primaryColor }} />
            )}
            <strong style={{ letterSpacing: 0.2, fontWeight: 800, color: primaryColor, fontSize: fs * 1.35 }}>{brandName}</strong>
          </div>
        </header>

        <div style={{ ...container, paddingTop: 0 }}>
          <div style={{ display: "flex" as const, alignItems: "center" as const, gap: 12, marginBottom: 14 }}>
            <motion.span
              initial={{ scale: 1 }}
              animate={{ scale: [1, 1.15, 1] }}
              transition={{ duration: 1.2, repeat: Infinity, ease: "easeInOut" }}
              style={{
                display: "inline-flex" as const,
                alignItems: "center" as const,
                gap: 8,
                padding: "8px 12px",
                borderRadius: 999,
                background: `${primaryColor}14`,
                color: primaryColor,
                fontWeight: 700,
                fontSize: fs * 0.95,
              }}
              aria-label="porcentaje de avance del curso"
            >
              {pct}%
            </motion.span>
            <div
              style={{
                flex: 1,
                height: 10,
                background: "rgba(0,0,0,0.08)",
                borderRadius: 999,
                overflow: "hidden" as const,
              }}
            >
              <div
                style={{
                  width: `${pct}%`,
                  height: "100%",
                  background: primaryColor,
                  borderRadius: 999,
                  transition: "width 220ms ease",
                }}
              />
            </div>
          </div>
        </div>

        <section>
          <div style={{ ...container }}>
            <motion.div variants={containerVar} initial="hidden" animate="show">
              <motion.div variants={itemVar} style={{ marginBottom: 18 }}>
                <h1 style={{ margin: 0, fontSize: fs * 2.1, lineHeight: 1.15 }}>{title}</h1>
                <p style={{ margin: "8px 0 0", opacity: 0.9, fontSize: fs * 1.1, whiteSpace: "pre-wrap" }}>
                  <span style={{ color: primaryColor, fontWeight: 700 }}>▌</span> {topicTitle}
                </p>
              </motion.div>

              <motion.div variants={itemVar}>
                <Card glow={primaryColor}>
                  <div
                    style={{
                      display: "flex" as const,
                      alignItems: "center" as const,
                      justifyContent: "space-between" as const,
                      marginBottom: 14,
                    }}
                  >
                    <strong style={{ fontSize: fs * 1.05 }}>
                      Pregunta {Math.min(idx + 1, total)} / {total}
                    </strong>
                    <div style={{ display: "flex" as const, alignItems: "center" as const, gap: 10 }}>
                      <div
                        style={{
                          width: 240,
                          height: 12,
                          background: "rgba(0,0,0,0.08)",
                          borderRadius: 999,
                          overflow: "hidden" as const,
                        }}
                      >
                        <div
                          style={{
                            width: `${quizProgressPct}%`,
                            height: "100%",
                            background: primaryColor,
                            borderRadius: 999,
                            transition: "width 220ms ease",
                          }}
                        />
                      </div>
                      <span style={{ fontSize: fs * 0.95, opacity: 0.75 }}>{quizProgressPct}%</span>
                    </div>
                  </div>

                  <p
                    style={{
                      margin: "10px 0 16px",
                      lineHeight: 1.55,
                      fontSize: fs * 1.1,
                      whiteSpace: "pre-wrap",
                    }}
                  >
                    {formattedQuestion}
                  </p>

                  <div
                    style={{
                      display: "grid" as const,
                      gridTemplateColumns: "repeat(auto-fit, minmax(260px, 1fr))",
                      gap: 12,
                      marginBottom: 14,
                    }}
                  >
                    {(q?.options ?? []).map((option, index) => {
                      const isSelected = selection[idx] === index
                      const isDisabled = !!checked[idx]
                      return (
                        <motion.div
                          key={index}
                          role="button"
                          onClick={() => handleSelect(index)}
                          style={{
                            padding: "14px 16px",
                            borderRadius: 12,
                            border: `2px solid ${isSelected ? primaryColor : "rgba(0,0,0,0.12)"}`,
                            background: isSelected ? `${primaryColor}10` : "#fff",
                            fontWeight: 700,
                            fontSize: fs * 1.0,
                            cursor: isDisabled ? "default" : "pointer",
                            userSelect: "none",
                            textAlign: "left",
                            boxShadow: isSelected ? "0 8px 24px rgba(0,0,0,0.06)" : "none",
                          }}
                          aria-pressed={isSelected}
                          whileHover={isDisabled ? undefined : { scale: 0.9 }}
                          whileTap={isDisabled ? undefined : { scale: 0.9 }}
                          transition={{ type: "spring", stiffness: 320, damping: 22 }}
                        >
                          {option ?? ""}
                        </motion.div>
                      )
                    })}
                  </div>

                  <div style={{ minHeight: 32, marginBottom: 14 }}>
                    {q && checked[idx] ? (
                      correct[idx] ? (
                        <div style={{ color: "#0a7f35", fontWeight: 700 }}>✅ ¡Correcto!</div>
                      ) : (
                        <div style={{ color: "#b00020", fontWeight: 700 }}>
                          ❌ Incorrecto. Respuesta: <strong>{q.options[q.correctIndex]}</strong>
                        </div>
                      )
                    ) : null}
                  </div>

                  {finished ? (
                    <div
                      style={{
                        marginTop: 18,
                        padding: 16,
                        border: `1px solid ${primaryColor}33`,
                        borderRadius: 12,
                        background: "#fff",
                        display: "flex" as const,
                        alignItems: "center" as const,
                        justifyContent: "space-between" as const,
                      }}
                    >
                      <strong>Resultado:</strong>
                      <span style={{ fontWeight: 800, color: primaryColor }}>
                        {score} / {total}
                      </span>
                    </div>
                  ) : null}
                </Card>
              </motion.div>
            </motion.div>
          </div>
        </section>
      </main>
    </div>
  )
}

function Page5({
  brandName = "BIZEN",
  logoSrc = "/bizen-mondragonlogo.png",
  primaryColor = "#0F62FE",
  background = "linear-gradient(180deg, #FFFFFF, #F8FAFF)",
  progressPercent = 90,
  title = "Sección 3",
  topicTitle = "Mi guía mínima de estilo",
  layoutOption = "B",
  baseFontSize = 18,
  instructions = DEFAULT_STYLE_INSTRUCTIONS,
  gridColumns = 1,
  gridGap = 16,
}: Page5Props) {
  const fs = Math.max(12, baseFontSize || 18)
  const isLeft = layoutOption === "A"
  const pct = Math.max(0, Math.min(100, Math.round(progressPercent || 0)))

  const list = (instructions?.length ? instructions : DEFAULT_STYLE_INSTRUCTIONS).map((text, index) => ({
    front: `Paso ${index + 1}`,
    back: text,
  }))

  const wrapper = useMemo(
    () => ({
      width: "100%",
      display: "flex" as const,
      justifyContent: isLeft ? "flex-start" : "center",
      background,
      color: "#111",
      fontFamily:
        "Montserrat, Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji",
      fontSize: fs,
    }),
    [background, isLeft, fs]
  )

  const container = useMemo(
    () => ({
      width: "100%",
      padding: "clamp(16px, 3vw, 32px)",
      boxSizing: "border-box" as const,
      margin: isLeft ? "0" : "0 auto",
    }),
    [isLeft]
  )

  return (
    <div style={wrapper}>
      <main style={{ width: "100%", display: "block" }}>
        <header style={{ ...container, paddingTop: 12, paddingBottom: 8 }}>
          <div style={{ display: "flex" as const, alignItems: "center" as const, gap: 12 }}>
            {logoSrc ? (
              <img src={logoSrc} alt={`${brandName} logo`} style={{ height: 62, width: "auto", display: "block" }} />
            ) : (
              <div aria-hidden style={{ width: 28, height: 28, borderRadius: 8, background: primaryColor }} />
            )}
            <strong style={{ letterSpacing: 0.2, fontWeight: 800, color: primaryColor, fontSize: fs * 1.35 }}>{brandName}</strong>
          </div>
        </header>

        <div style={{ ...container, paddingTop: 0 }}>
          <div style={{ display: "flex" as const, alignItems: "center" as const, gap: 12, marginBottom: 14 }}>
            <motion.span
              initial={{ scale: 1 }}
              animate={{ scale: [1, 1.15, 1] }}
              transition={{ duration: 1.2, repeat: Infinity, ease: "easeInOut" }}
              style={{
                display: "inline-flex" as const,
                alignItems: "center" as const,
                gap: 8,
                padding: "8px 12px",
                borderRadius: 999,
                background: `${primaryColor}14`,
                color: primaryColor,
                fontWeight: 700,
                fontSize: fs * 0.95,
              }}
              aria-label="porcentaje de avance del curso"
            >
              {pct}%
            </motion.span>
            <div
              style={{
                flex: 1,
                height: 10,
                background: "rgba(0,0,0,0.08)",
                borderRadius: 999,
                overflow: "hidden" as const,
              }}
            >
              <motion.div
                initial={{ scaleY: 1 }}
                animate={{ scaleY: [1, 1.06, 1] }}
                transition={{ duration: 1.2, repeat: Infinity, ease: "easeInOut" }}
                style={{
                  width: `${pct}%`,
                  height: "100%",
                  background: primaryColor,
                  borderRadius: 999,
                  transformOrigin: "center",
                }}
              />
            </div>
          </div>
        </div>

        <section>
          <div style={{ ...container }}>
            <motion.div variants={containerVar} initial="hidden" animate="show">
              <motion.div variants={itemVar} style={{ marginBottom: 14 }}>
                <h1 style={{ margin: 0, fontSize: fs * 2.3, lineHeight: 1.15 }}>{title}</h1>
                <p style={{ margin: "8px 0 0", opacity: 0.9, fontSize: fs * 1.15 }}>
                  <span style={{ color: primaryColor, fontWeight: 700 }}>▌</span> {topicTitle}
                </p>
              </motion.div>

              <motion.div variants={itemVar} style={{ marginBottom: 18 }}>
                <Card glow={primaryColor}>
                  <p style={{ margin: 0, color: primaryColor, fontSize: fs, lineHeight: 1.6 }}>
                    🎯 Escribe tu guía mínima en <b>un párrafo</b>: paleta → prendas → encuadre → reglas de portadas →
                    por qué refleja tu identidad.
                  </p>
                </Card>
              </motion.div>

              <motion.div variants={itemVar} style={{ marginBottom: 16 }}>
                <Card glow={primaryColor}>
                  <h3 style={{ margin: "0 0 12px 0", fontSize: fs * 1.3 }}>Actividad práctica: Mi guía mínima de estilo</h3>
                  <p style={{ margin: "0 0 16px 0", opacity: 0.8 }}>
                    Toca cada tarjeta para ver la instrucción. Redacta <b>un solo párrafo</b> que integre los 5 puntos.
                  </p>

                  <GridFlashcards gap={gridGap} columns={gridColumns}>
                    {list.map((card, index) => (
                      <Flashcard
                        key={index}
                        front={card.front}
                        back={card.back}
                        primaryColor={primaryColor}
                        fontSize={fs}
                      />
                    ))}
                  </GridFlashcards>
                </Card>
              </motion.div>
            </motion.div>
          </div>
        </section>
      </main>
    </div>
  )
}

function Placeholder({ label }: { label: string }) {
  return (
    <div style={{ padding: 40, textAlign: "center" }}>
      <h2 style={{ margin: 0 }}>{label}</h2>
      <p style={{ marginTop: 8, color: "#64748b" }}>Contenido en construcción.</p>
    </div>
  )
}

const M3S3_CONTENT: Record<number, React.ReactNode> = {
  1: <Page1 />,
  2: <Page2 />,
  3: <Page3 />,
  4: <Page4 />,
  5: <Page5 />,
}

export default M3S3_CONTENT
